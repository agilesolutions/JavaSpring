spring:
  application:
    name: allinone
  security:
    oauth2:
      resourceserver:
        jwt:
# ${wiremock.server.port} is automatically injected by the WireMock Spring integration.
          jwk-set-uri: http://localhost:8787/.well-known/jwks.json
  datasource:
    DriverClassName: org.postgresql.Driver
    url: jdbc:postgresql://localhost:5438/shares
    username: postgres
    password: postgres
    hikari:
      # If you’re seeing connection closed exceptions with a Spring Boot + HikariCP + PostgreSQL setup, it usually means that Hikari is handing out connections that the database has already closed—often due to database timeouts, idle connection limits, or network interruptions.
      # The “optimum” settings aren’t one-size-fits-all—they depend on your database’s configuration, workload, and infrastructure
      # This is a tested baseline configuration that fixes the closed-connection issue in most PostgreSQL deployments.
      # Core Pool Size
      pool-name: course-service-pool
      maximum-pool-size: 20
      minimum-idle: 5
      # Connection lifetime & idle handling
      idle-timeout: 300000       # 5 minutes
      max-lifetime: 1800000      # 30 minutes
      # Connection validation
      connection-test-query: SELECT 1
      validation-timeout: 5000   # 5 seconds

  jpa:
    defer-datasource-initialization: true
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    generate-ddl: true
    hibernate:
      ddl-auto: create-drop #this recreates the db, not recommended for prod
    show-sql: true
    properties:
      hibernate:
        jdbc:
          lob:
            non_contextual_creation: true
  data:
    mongodb:
      database: test
      port: 27017

  cloud:
    function:
      definition: accountProcessor; accountConsumer; fraudConsumer
    stream:
      function.routing.enabled: true
      bindings:
        accountProcessor-in-0:
          destination: accounts-topic
          group: accountService
        accountProcessor-out-0:
          destination: processed-accounts-topic
        accountConsumer-in-0:
          destination: processed-accounts-topic
          group: internalAccountService
        fraudConsumer-in-0:
          destination: processed-accounts-topic
          group: fraudService



twelvedata:
  api:
    url: https://api.twelvedata.com/
    key: demo

service:
  retry:
    max-attempts: 3
    initial-delay: 1000
    max-delay: 5000
    multiplier: 2.0
